"use strict";(self.webpackChunkshield=self.webpackChunkshield||[]).push([[59],{9365:(e,a,t)=>{t.d(a,{A:()=>i});var n=t(6540),r=t(53);const s="tabItem_Ymn6";function i(e){let{children:a,hidden:t,className:i}=e;return n.createElement("div",{role:"tabpanel",className:(0,r.A)(s,i),hidden:t},a)}},4865:(e,a,t)=>{t.d(a,{A:()=>m});var n=t(8168),r=t(6540),s=t(53),i=t(2303),l=t(1682),o=t(6976),c=t(3104);const u="tabList__CuJ",d="tabItem_LNqP";function p(e){const{lazy:a,block:t,defaultValue:i,values:p,groupId:m,className:h}=e,g=r.Children.map(e.children,(e=>{if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),b=p??g.map((e=>{let{props:{value:a,label:t,attributes:n}}=e;return{value:a,label:t,attributes:n}})),f=(0,l.X)(b,((e,a)=>e.value===a.value));if(f.length>0)throw new Error(`Docusaurus error: Duplicate values "${f.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const y=null===i?i:i??g.find((e=>e.props.default))?.props.value??g[0].props.value;if(null!==y&&!b.some((e=>e.value===y)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${y}" but none of its children has the corresponding value. Available values are: ${b.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:v,setTabGroupChoices:k}=(0,o.x)(),[w,T]=(0,r.useState)(y),A=[],{blockElementScrollPositionUntilNextRender:x}=(0,c.a_)();if(null!=m){const e=v[m];null!=e&&e!==w&&b.some((a=>a.value===e))&&T(e)}const E=e=>{const a=e.currentTarget,t=A.indexOf(a),n=b[t].value;n!==w&&(x(a),T(n),null!=m&&k(m,String(n)))},I=e=>{let a=null;switch(e.key){case"Enter":E(e);break;case"ArrowRight":{const t=A.indexOf(e.currentTarget)+1;a=A[t]??A[0];break}case"ArrowLeft":{const t=A.indexOf(e.currentTarget)-1;a=A[t]??A[A.length-1];break}}a?.focus()};return r.createElement("div",{className:(0,s.A)("tabs-container",u)},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":t},h)},b.map((e=>{let{value:a,label:t,attributes:i}=e;return r.createElement("li",(0,n.A)({role:"tab",tabIndex:w===a?0:-1,"aria-selected":w===a,key:a,ref:e=>A.push(e),onKeyDown:I,onClick:E},i,{className:(0,s.A)("tabs__item",d,i?.className,{"tabs__item--active":w===a})}),t??a)}))),a?(0,r.cloneElement)(g.filter((e=>e.props.value===w))[0],{className:"margin-top--md"}):r.createElement("div",{className:"margin-top--md"},g.map(((e,a)=>(0,r.cloneElement)(e,{key:a,hidden:e.props.value!==w})))))}function m(e){const a=(0,i.A)();return r.createElement(p,(0,n.A)({key:String(a)},e))}},8716:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>u,toc:()=>p});var n=t(8168),r=(t(6540),t(5680)),s=t(4865),i=t(9365),l=t(7964);const o={},c="Checking Pemrissions",u={unversionedId:"guides/check-permission",id:"guides/check-permission",title:"Checking Pemrissions",description:"There are two ways to check a user permission on a resource in shield,",source:"@site/docs/guides/check-permission.md",sourceDirName:"guides",slug:"/guides/check-permission",permalink:"/shield/guides/check-permission",draft:!1,editUrl:"https://github.com/goto/shield/edit/master/docs/docs/guides/check-permission.md",tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Managing Group",permalink:"/shield/guides/managing-group"},next:{title:"Manage Resources",permalink:"/shield/guides/managing-resource"}},d={},p=[{value:"API Interface",id:"api-interface",level:2},{value:"Proxy Middleware",id:"proxy-middleware",level:2}],m={toc:p};function h(e){let{components:a,...t}=e;return(0,r.yg)("wrapper",(0,n.A)({},m,t,{components:a,mdxType:"MDXLayout"}),(0,r.yg)("h1",{id:"checking-pemrissions"},"Checking Pemrissions"),(0,r.yg)("p",null,"There are two ways to check a user permission on a resource in shield,"),(0,r.yg)("h2",{id:"api-interface"},"API Interface"),(0,r.yg)(s.A,{groupId:"api",mdxType:"Tabs"},(0,r.yg)(i.A,{value:"HTTP",label:"HTTP",default:!0,mdxType:"TabItem"},(0,r.yg)(l.A,{className:"language-bash",mdxType:"CodeBlock"},'$ curl --location --request POST \'http://localhost:8000/admin/v1beta1/check\'\n--header \'Content-Type: application/json\'\n--header \'Accept: application/json\'\n--header \'X-Shield-Email: doe.john@gotocompany.com\'\n--data-raw \'{\n  "objectId": "test-resource-beta1",\n  "objectNamespace": "entropy/firehose",\n  "permission": "owner"\n}\''))),(0,r.yg)("h2",{id:"proxy-middleware"},"Proxy Middleware"),(0,r.yg)("p",null,"Users can add middleware in the rules set to check permission. Middlewares will be called before the proxy call and will not call the services if authorization fails."),(0,r.yg)("p",null,"The shield will read the action from the config, resource id from the path params, and UserId of the current user."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},'- name: test-res\n  path: /test-res\n  target: "http://127.0.0.1:3000/"\n  methods: ["PUT"]\n  frontends:\n    - name: test_api\n      path: "/test-res/{resource_id}"\n      method: "PUT"\n      middlewares:\n        - name: authz\n          config:\n            actions:\n              - test-res_all_actions\n              - test-res_cancel\n            attributes:\n              project:\n                key: X-Shield-Project\n                type: header\n                source: request\n')))}h.isMDXComponent=!0}}]);